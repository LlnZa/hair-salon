from app import app
from models import db, Услуги, Филиалы, Сотрудники
from datetime import datetime

def init_test_data():
    with app.app_context():
        # Создаем филиал, если его нет
        if not Филиалы.query.first():
            main_branch = Филиалы(
                название='Главный филиал',
                адрес='Основной адрес',
                телефон='+7 (999) 123-45-67'
            )
            db.session.add(main_branch)
            db.session.commit()
            main_branch_id = main_branch.филиал_id
        else:
            main_branch_id = Филиалы.query.first().филиал_id

        # Создаем администратора, если его нет
        if not Сотрудники.query.filter_by(логин='admin').first():
            admin = Сотрудники(
                филиал_id=main_branch_id,
                логин='admin',
                имя='Admin',
                фамилия='Admin',
                должность='Администратор',
                роль='admin',
                дата_приёма=datetime.now().date()
            )
            admin.set_password('admin')
            db.session.add(admin)
            db.session.commit()

        # Создаем тестовые услуги
        services = [
            {
                'название_услуги': 'Стрижка мужская',
                'описание': 'Классическая мужская стрижка с учетом особенностей волос',
                'базовая_цена': 1500.00,
                'категория_пола': 'мужская'
            },
            {
                'название_услуги': 'Стрижка женская',
                'описание': 'Женская стрижка с учетом типа волос и формы лица',
                'базовая_цена': 2000.00,
                'категория_пола': 'женская'
            },
            {
                'название_услуги': 'Окрашивание волос',
                'описание': 'Полное окрашивание волос с учетом их состояния',
                'базовая_цена': 3500.00,
                'категория_пола': 'универсальная'
            },
            {
                'название_услуги': 'Укладка',
                'описание': 'Создание прически с использованием профессиональных средств',
                'базовая_цена': 1000.00,
                'категория_пола': 'универсальная'
            }
        ]

        # Очищаем таблицу услуг
        Услуги.query.delete()
        
        # Добавляем новые услуги
        for service_data in services:
            service = Услуги(**service_data)
            db.session.add(service)
        
        db.session.commit()
        print("Тестовые данные успешно добавлены в базу данных")

if __name__ == '__main__':
    init_test_data() 